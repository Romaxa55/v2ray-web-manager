# v2ray-web-manager
 Проект v2ray-web-manager включает в себя административный интерфейс и proxy-интерфейс. Административный интерфейс предоставляет функции управления. Proxy-интерфейс предоставляет основные функции управления трафиком, идентификацией аккаунтов и перенаправлением трафика, поддерживая при этом несколько моделей перенаправления трафика (1 к 1, 1 к многим).
 
 Основой проекта является промежуточное ПО транспортного уровня, находящееся между пользователем и v2ray. Реализовано через перенаправление трафика. В теории поддерживаются все протоколы верхнего уровня, на данный момент адаптирован к протоколу ws. 
 
 Поддержка ssl/tls осуществляется с помощью инструментов, таких как nginx, или может быть предоставлена через CDN.

 
  ## Особенности:
  * Управление трафиком (QoS) - непревзойденный контроль скорости, трафика и числа соединений. Все можно настроить гибко.
  * Управление аккаунтами
  * Управление трафиком - автоматическое отключение при истечении срока действия или превышении лимита трафика
  * Управление серверами 
  * Управление объявлениями
  * Разграничение прав
  * Регистрация по пригласительному коду
  * Подписка
  * Уровни
 
 
 
#### Если это помогло вам, пожалуйста, поставьте `watch` `star` `Fork`
  
 ## Фронтенд-проект
   [Фронтенд-проект->v2ray-manager-console](https://github.com/Romaxa55/v2ray-manager-console)
 

 
 ## Краткий обзор
 Конфигурация сервера
 ![Сервер](https://github.com/Romaxa55/v2ray-web-manager/raw/master/static/admin_index.png)
 
 Страница учетной записи администратора 
 ![Страница администратора](https://github.com/Romaxa55/v2ray-web-manager/raw/master/static/admin_account.png)
 
Страница для обычных пользователей
 ![Страница пользователя]( https://raw.githubusercontent.com/Romaxa55/v2ray-web-manager/master/static/my-account.png)

Для просмотра других страниц попробуйте самостоятельно.
 
 ## 1. Начало использования 
   
 #### Требования к системе
 
    * Java 8 и выше
    * Память не менее 300 МБ
    * CPU vCPU 1 ядро
    * Nginx или другой аналогичный инструмент


   
 #### Руководство
 
  [Пошаговая инструкция по установке с нуля](https://github.com/Romaxa55/v2ray-web-manager/blob/master/step-by-step-install.md)
  
  [Пошаговая инструкция по настройке сайта с нуля](https://github.com/Romaxa55/v2ray-web-manager/blob/master/step-by-step-conf.md)
  
  [Средний уровень - предоставление поддержки tls (https/wss)](https://github.com/Romaxa55/v2ray-web-manager/blob/master/support-https.md)
    
  [Продвинутый уровень - режимы](https://github.com/Romaxa55/v2ray-web-manager/blob/master/step-by-step-model.md)
  
  [Продвинутый уровень - практика кластерного режима](https://github.com/Romaxa55/v2ray-web-manager/blob/master/cluster.md)

  ##### Другие версии
  
  [Начните с Docker](https://github.com/Romaxa55/v2ray-web-manager/blob/master/step-by-step-docker.md)

## 2. Обслуживание и управление 

### База данных

   База данных - по умолчанию создается в `/opt/jar/db` как admin.db. Регулярно сохраняйте.

### Обновление
   Перед обновлением прочтите журнал обновлений
  #### [Журнал обновлений](https://github.com/Romaxa55/v2ray-web-manager/blob/master/updated-log.md)



   * Загрузите соответствующий пакет релиза

     [Страница релизов Java-сервиса](https://github.com/Romaxa55/v2ray-web-manager/releases)
         
     [Страница релизов фронтенд-сервиса](https://github.com/Romaxa55/v2ray-manager-console/releases)
       

   * Остановите Java-сервис


```
Остановите admin
# ps -ef | grep admin-
# kill [ID процесса]
# ps -ef | grep v2ray-proxy-
# kill [ID процесса]

 ```
* [Перезапустите сервис](https://github.com/Romaxa55/v2ray-web-manager/blob/master/step-by-step-install.md#6-%E8%BF%90%E8%A1%8Cjava)

### Сброс пароля администратора
> Сбросьте пароль или создайте новую учетную запись на основе файла конфигурации.
```bash
# x.y.z - это номер версии, поддержка предоставляется для версий, начиная с 3.1.4
java -jar admin-x.y.z.jar --spring.config.location=/opt/jar/admin.yaml restpwd

```
     
### Оптимизация

   #### [-> Ситуация с использованием памяти <-](https://github.com/Romaxa55/v2ray-web-manager/blob/master/memory.md)
   
   #### Уменьшение использования памяти Java
   
   1. Используйте другие JRE, такие как：[openj9-eclipse](https://www.eclipse.org/openj9/), чтобы существенно уменьшить использование памяти без ущерба для производительности.


## Тестирование

### Тестирование ограничения скорости
    
   Примечание: локальная пропускная способность вниз 50 Мбит/с, вверх около 8 Мбит/с. Ограничение скорости на стороне администратора составляет 2 МБ/с, результаты тестирования представлены на рисунке:
    
![Тест1](https://www.speedtest.net/result/8927382635.png)
   
   Результаты тестирования: вниз 16.36/8=2.1, что соответствует настройке администратора в 2 МБ/с.
## Участие в проекте
  * Посмотрите [todo-list](https://github.com/Romaxa55/v2ray-web-manager/blob/master/todo-list.md) проекта. Если у вас есть навыки и время, чтобы реализовать это, мы приветствуем pull request.
  * Любые ошибки/ошибки в документации можно исправить с помощью pull request.
  * Идеи/оптимизации/новые функции обсуждаются перед pull request 

   
## Архитектура
Текущая архитектура:

![Текущая](https://raw.githubusercontent.com/Romaxa55/v2ray-web-manager/master/static/now.png)

Будущая архитектура (разработка не продолжается):

![Будущая](https://raw.githubusercontent.com/Romaxa55/v2ray-web-manager/master/static/future.png)

## Структура проекта
   * Общие
   * Proxy промежуточное ПО - ядро
        * Поддержка разбора аккаунтов
        * Управление трафиком
        * Отчеты о трафике
        * Перенаправление трафика
   * v2ray-jdk - пакет поддержки v2ray rpc
   * vpn-admin - API административного интерфейса
        * Управление функциями пользователя/аккаунта и т. д.
   
   
## Предупреждение
Пожалуйста, следуйте законам вашей страны при использовании. Только для учебных и исследовательских целей.
## Лицензия
Этот проект лицензирован по лицензии MIT.

